{"version":3,"sources":["webpack://CMSBrowserComponents//root/node_modules/@base-cms/marko-web/browser/components/oembed.vue","webpack://CMSBrowserComponents//root/node_modules/@base-cms/marko-web/browser/components/oembed.vue?1f30","webpack://CMSBrowserComponents//root/node_modules/@base-cms/marko-web/browser/components/oembed.vue?95ba","webpack://CMSBrowserComponents/../../node_modules/@base-cms/marko-web/browser/components/oembed.vue","webpack://CMSBrowserComponents//root/node_modules/@base-cms/marko-web/browser/components/oembed.vue?2620"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAqF;AAC3B;AACL;;;AAGrD;AACmF;AACnF,gBAAgB,8FAAU;AAC1B,EAAE,4EAAM;AACR,EAAE,iFAAM;AACR,EAAE,0FAAe;AACjB;AACA;AACA;AACA;;AAEA;;AAEA;AACA,IAAI,KAAU,EAAE,YAiBf;AACD;AACe,gF;;;;;;;;;;;;ACtCf;AAAA;AAAA,wCAAgK,CAAgB,sNAAG,EAAC,C;;;;;;;;;;;;ACApL;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACcA;AACA;AACA;AACA,kBADA;AAEA;AAFA,KADA;AAKA;AACA,kBADA;AAEA;AAFA,KALA;AASA;AACA,kBADA;AAEA;AAAA;AAAA;AAFA,KATA;AAaA;AACA,kBADA;AAEA;AAFA;AAbA,GADA;AAmBA;AAAA;AACA,oBADA;AAEA,iBAFA;AAGA,iBAHA;AAIA,sBAJA;AAKA,oBALA;AAMA;AANA;AAAA,GAnBA;AA2BA;AACA,MADA,gBACA;AACA;AACA;AACA,KAJA;AAKA,QALA,kBAKA;AACA;AACA;AACA;AACA;AACA;AAVA,GA3BA;AAuCA,SAvCA,qBAuCA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;;AACA;AACA;;AACA;AAAA,4CACA,mBADA;AAAA,sBACA,IADA,uBACA,IADA;AAAA,sBACA,KADA,uBACA,KADA;AAEA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA,OAjBA;AAkBA;AACA;AAAA;AAAA;AAAA;AACA;AACA,GAlEA;AAmEA,eAnEA,2BAmEA;AACA;AACA;AACA,GAtEA;AAuEA;AACA,YADA,0BACA;AAAA;AACA;AACA,KAHA;AAIA,QAJA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAKA;AACA,oBANA,aAMA,eANA,kBAMA,4BANA;AAAA;AAAA;AAAA,uBAQA;AAAA;AAAA,kBARA;;AAAA;AAQA,iBARA;AAAA;AAAA,uBASA,QATA;;AAAA;AAAA;AASA,oBATA,SASA,IATA;AASA,oBATA,SASA,IATA;AASA,wBATA,SASA,aATA;AAUA;AACA;AACA;AAZA;AAAA;;AAAA;AAAA;AAAA;AAcA;AACA;;AAfA;AAAA;AAiBA;AACA;AAlBA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAvEA,G;;;;;;;;;;;;ACdA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,eAAe;AACf,GAAG;AACH;AACA;AACA","file":"oembed.21f32290.js","sourcesContent":["import { render, staticRenderFns } from \"./oembed.vue?vue&type=template&id=d056b306&\"\nimport script from \"./oembed.vue?vue&type=script&lang=js&\"\nexport * from \"./oembed.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/root/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('d056b306')) {\n      api.createRecord('d056b306', component.options)\n    } else {\n      api.reload('d056b306', component.options)\n    }\n    module.hot.accept(\"./oembed.vue?vue&type=template&id=d056b306&\", function () {\n      api.rerender('d056b306', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"node_modules/@base-cms/marko-web/browser/components/oembed.vue\"\nexport default component.exports","import mod from \"-!../../../../babel-loader/lib/index.js??ref--1!../../../../vue-loader/lib/index.js??vue-loader-options!./oembed.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../babel-loader/lib/index.js??ref--1!../../../../vue-loader/lib/index.js??vue-loader-options!./oembed.vue?vue&type=script&lang=js&\"","export * from \"-!../../../../vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../vue-loader/lib/index.js??vue-loader-options!./oembed.vue?vue&type=template&id=d056b306&\"","<!-- eslint-disable vue/no-v-html-->\n<template>\n  <span\n    :id=\"id\"\n    class=\"lazyload\"\n    :data-embed-type=\"attrs.type\"\n    :data-oembed-type=\"oembedType\"\n    :data-oembed-provider=\"provider\"\n    :data-expand=\"expand\"\n    v-html=\"html\"\n  />\n</template>\n\n<script>\nexport default {\n  props: {\n    url: {\n      type: String,\n      required: true,\n    },\n    expand: {\n      type: Number,\n      default: 250,\n    },\n    attrs: {\n      type: Object,\n      default: () => ({}),\n    },\n    mountPoint: {\n      type: String,\n      required: true,\n    },\n  },\n  data: () => ({\n    loading: false,\n    error: null,\n    embed: null,\n    oembedType: null,\n    provider: null,\n    observer: null,\n  }),\n  computed: {\n    id() {\n      const clean = `${this.attrs.id}`.replace(/[\\W|-]/ig, '');\n      return `${clean}-${Date.now()}`;\n    },\n    html() {\n      if (this.embed) return this.embed;\n      if (this.error) return `<pre>An unexpected error occurred: ${this.error.message}</pre>`;\n      if (this.loading) return `Loading embed from ${this.url}`;\n      return '';\n    },\n  },\n  mounted() {\n    document.addEventListener('lazybeforeunveil', this.lazyload.bind(this));\n    if (window.MutationObserver) {\n      // inline script tags aren't added to the DOM, so the twitter widget never loads\n      // This would be widespread -- if the payload returns a script tag, ensure that it is\n      // appended to the head rather than written as part of the `embed` code here.\n      this.observer = new MutationObserver((mutationList) => {\n        for (let i = 0; i < mutationList.length; i += 1) {\n          const mutation = mutationList[i];\n          if (mutation.type === 'childList') {\n            for (let x = 0; x < mutation.addedNodes.length; x += 1) {\n              const added = mutation.addedNodes[x];\n              if (added.tagName && added.tagName === 'SCRIPT') {\n                const script = document.createElement('script');\n                for (let n = 0; n < added.attributes.length; n += 1) {\n                  const { name, value } = added.attributes[n];\n                  script.setAttribute(name, value);\n                }\n                document.querySelector('head').appendChild(script);\n              }\n            }\n          }\n        }\n      });\n      const node = document.getElementById(this.id);\n      this.observer.observe(node, { childList: true, subtree: true });\n    }\n  },\n  beforeDestroy() {\n    document.removeEventListener('lazybeforeunveil', this.lazyload);\n    if (this.observer) this.observer.disconnect();\n  },\n  methods: {\n    lazyload({ target }) {\n      if (target.id === this.id) this.load();\n    },\n    async load() {\n      this.loading = true;\n      const href = `${this.mountPoint}?url=${encodeURIComponent(this.url)}`;\n      try {\n        const r = await fetch(href, { credentials: 'same-origin' });\n        const { html, type, provider_name: provider } = await r.json();\n        this.oembedType = type;\n        this.provider = provider;\n        this.embed = html;\n      } catch (e) {\n        // @todo Log this!\n        this.error = e;\n      } finally {\n        this.loading = false;\n        document.removeEventListener('lazybeforeunveil', this.lazyload);\n      }\n    },\n  },\n};\n</script>\n","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"span\", {\n    staticClass: \"lazyload\",\n    attrs: {\n      id: _vm.id,\n      \"data-embed-type\": _vm.attrs.type,\n      \"data-oembed-type\": _vm.oembedType,\n      \"data-oembed-provider\": _vm.provider,\n      \"data-expand\": _vm.expand\n    },\n    domProps: { innerHTML: _vm._s(_vm.html) }\n  })\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }"],"sourceRoot":""}