{"version":3,"sources":["webpack://CMSBrowserComponents//root/node_modules/@base-cms/marko-web-gam/browser/inject-ads.vue","webpack://CMSBrowserComponents//root/node_modules/@base-cms/marko-web-gam/browser/inject-ads.vue?a4ed","webpack://CMSBrowserComponents//root/node_modules/@base-cms/marko-web-gam/browser/inject-ads.vue?f094","webpack://CMSBrowserComponents/../../node_modules/@base-cms/marko-web-gam/browser/inject-ads.vue","webpack://CMSBrowserComponents//root/node_modules/@base-cms/marko-web-gam/browser/inject-ads.vue?9a69"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAyF;AAC3B;AACL;;;AAGzD;AACgF;AAChF,gBAAgB,8FAAU;AAC1B,EAAE,gFAAM;AACR,EAAE,qFAAM;AACR,EAAE,8FAAe;AACjB;AACA;AACA;AACA;;AAEA;;AAEA;AACA,IAAI,KAAU,EAAE,YAiBf;AACD;AACe,gF;;;;;;;;;;;;ACtCf;AAAA;AAAA,wCAA8J,CAAgB,0NAAG,EAAC,C;;;;;;;;;;;;ACAlL;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;ACKA;AAEA;AACA;AACA;AACA,kBADA;AAEA;AAFA,KADA;AAKA;AACA,kBADA;AAEA;AAFA,KALA;AASA;AACA,kBADA;AAEA;AAAA;AAAA;AAFA;AATA,GADA;AAgBA;AAAA;AACA;AADA;AAAA,GAhBA;AAoBA;AACA,aADA,uBACA;AACA;AACA,KAHA;AAIA,iBAJA,2BAIA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AANA,GApBA;AA6BA,SA7BA,qBA6BA;AACA;AADA,QAEA,aAFA,GAEA,IAFA,CAEA,aAFA;AAGA;AACA;AACA;AAEA;AACA;;AADA,yBAEA,aAFA;AAAA,UAEA,MAFA,gBAEA,MAFA;;AAGA;AAEA;AACA;AACA,oCADA;AAEA,kCAFA;AAGA,6BAHA;AAIA,2BAJA;AAKA;AALA,YAMA;AACA;;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eALA;AAMA,aARA,MAQA;AACA;AACA;AACA;;AACA;AACA;AACA,OA1BA;AA2BA;AACA,KAjCA;AAkCA,GAtEA;AAwEA;AACA,aADA,uBAOA;AAAA;AAAA,UALA,YAKA,QALA,YAKA;AAAA,UAJA,WAIA,QAJA,WAIA;AAAA,UAHA,WAGA,QAHA,WAGA;AAAA,UAFA,UAEA,QAFA,UAEA;AAAA,UADA,cACA,QADA,cACA;;AACA;AACA;AACA,4CACA,yCADA,IAEA,iCAFA;AAGA;AAbA;AAxEA,G;;;;;;;;;;;;ACPA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA,kBAAkB,kBAAkB;AACpC,YAAY;AACZ,GAAG;AACH;AACA;AACA","file":"gam-inject-ads.56a8c851.js","sourcesContent":["import { render, staticRenderFns } from \"./inject-ads.vue?vue&type=template&id=f871f2f8&\"\nimport script from \"./inject-ads.vue?vue&type=script&lang=js&\"\nexport * from \"./inject-ads.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/root/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('f871f2f8')) {\n      api.createRecord('f871f2f8', component.options)\n    } else {\n      api.reload('f871f2f8', component.options)\n    }\n    module.hot.accept(\"./inject-ads.vue?vue&type=template&id=f871f2f8&\", function () {\n      api.rerender('f871f2f8', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"node_modules/@base-cms/marko-web-gam/browser/inject-ads.vue\"\nexport default component.exports","import mod from \"-!../../../babel-loader/lib/index.js??ref--1!../../../vue-loader/lib/index.js??vue-loader-options!./inject-ads.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../babel-loader/lib/index.js??ref--1!../../../vue-loader/lib/index.js??vue-loader-options!./inject-ads.vue?vue&type=script&lang=js&\"","export * from \"-!../../../vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../vue-loader/lib/index.js??vue-loader-options!./inject-ads.vue?vue&type=template&id=f871f2f8&\"","<template>\n  <div :id=\"elementId\" style=\"display: none;\" />\n</template>\n\n<script>\nimport $ from '@base-cms/marko-web/browser/jquery';\n\nexport default {\n  props: {\n    selector: {\n      type: String,\n      required: true,\n    },\n    childSelector: {\n      type: String,\n      default: 'p',\n    },\n    toInject: {\n      type: Object,\n      default: () => ({}),\n    },\n  },\n\n  data: () => ({\n    hasInjected: {},\n  }),\n\n  computed: {\n    elementId() {\n      return `marko-web-gam-inject-ads-${Date.now()}`;\n    },\n    targetLengths() {\n      return Object.keys(this.toInject).map(n => parseInt(n, 10)).filter(n => n && n >= 1);\n    },\n  },\n\n  mounted() {\n    let totalLength = 0;\n    const { childSelector } = this;\n    const component = this;\n    const $el = $(this.selector);\n    const $children = $(`> ${childSelector}`, $el);\n\n    $children.each(function injectAds(index) {\n      const $child = $(this);\n      const { length } = $child.text();\n      const $nextChild = $(this).next(childSelector);\n\n      component.targetLengths.forEach((targetLength) => {\n        if (component.canInject({\n          targetLength,\n          totalLength,\n          childLength: length,\n          childIndex: index,\n          childrenLength: $children.length,\n        })) {\n          const contents = component.toInject[targetLength];\n          if (contents) {\n            // Unescape closing HTML tags.\n            const cleaned = contents.replace(/<\\\\\\/(.+?)>/g, '</$1>');\n            if ($nextChild.text().length <= 1) {\n              // eslint-disable-next-line consistent-return\n              $child.nextAll(childSelector).each(function handleBefore() {\n                if ($(this).text().length > 1) {\n                  $(this).before(cleaned);\n                  return false;\n                }\n              });\n            } else {\n              $child.after(cleaned);\n            }\n          }\n          component.hasInjected[targetLength] = true;\n        }\n      });\n      totalLength += length;\n    });\n  },\n\n  methods: {\n    canInject({\n      targetLength,\n      totalLength,\n      childLength,\n      childIndex,\n      childrenLength,\n    } = {}) {\n      const hasInjected = this.hasInjected[targetLength];\n      if (hasInjected || !targetLength) return false;\n      return totalLength <= targetLength\n        && totalLength + childLength >= targetLength\n        && childIndex + 1 !== childrenLength;\n    },\n  },\n};\n</script>\n","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"div\", {\n    staticStyle: { display: \"none\" },\n    attrs: { id: _vm.elementId }\n  })\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }"],"sourceRoot":""}