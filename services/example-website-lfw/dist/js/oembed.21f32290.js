(window["webpackJsonpCMSBrowserComponents"] = window["webpackJsonpCMSBrowserComponents"] || []).push([["oembed"],{

/***/ "../../node_modules/@base-cms/marko-web/browser/components/oembed.vue":
/*!****************************************************************************!*\
  !*** /root/node_modules/@base-cms/marko-web/browser/components/oembed.vue ***!
  \****************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _oembed_vue_vue_type_template_id_d056b306___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./oembed.vue?vue&type=template&id=d056b306& */ "../../node_modules/@base-cms/marko-web/browser/components/oembed.vue?vue&type=template&id=d056b306&");
/* harmony import */ var _oembed_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./oembed.vue?vue&type=script&lang=js& */ "../../node_modules/@base-cms/marko-web/browser/components/oembed.vue?vue&type=script&lang=js&");
/* empty/unused harmony star reexport *//* harmony import */ var _vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../vue-loader/lib/runtime/componentNormalizer.js */ "../../node_modules/vue-loader/lib/runtime/componentNormalizer.js");





/* normalize component */

var component = Object(_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_2__["default"])(
  _oembed_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__["default"],
  _oembed_vue_vue_type_template_id_d056b306___WEBPACK_IMPORTED_MODULE_0__["render"],
  _oembed_vue_vue_type_template_id_d056b306___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"],
  false,
  null,
  null,
  null
  
)

/* hot reload */
if (false) { var api; }
component.options.__file = "node_modules/@base-cms/marko-web/browser/components/oembed.vue"
/* harmony default export */ __webpack_exports__["default"] = (component.exports);

/***/ }),

/***/ "../../node_modules/@base-cms/marko-web/browser/components/oembed.vue?vue&type=script&lang=js&":
/*!*****************************************************************************************************!*\
  !*** /root/node_modules/@base-cms/marko-web/browser/components/oembed.vue?vue&type=script&lang=js& ***!
  \*****************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _babel_loader_lib_index_js_ref_1_vue_loader_lib_index_js_vue_loader_options_oembed_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../../babel-loader/lib??ref--1!../../../../vue-loader/lib??vue-loader-options!./oembed.vue?vue&type=script&lang=js& */ "../../node_modules/babel-loader/lib/index.js?!../../node_modules/vue-loader/lib/index.js?!../../node_modules/@base-cms/marko-web/browser/components/oembed.vue?vue&type=script&lang=js&");
/* empty/unused harmony star reexport */ /* harmony default export */ __webpack_exports__["default"] = (_babel_loader_lib_index_js_ref_1_vue_loader_lib_index_js_vue_loader_options_oembed_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__["default"]); 

/***/ }),

/***/ "../../node_modules/@base-cms/marko-web/browser/components/oembed.vue?vue&type=template&id=d056b306&":
/*!***********************************************************************************************************!*\
  !*** /root/node_modules/@base-cms/marko-web/browser/components/oembed.vue?vue&type=template&id=d056b306& ***!
  \***********************************************************************************************************/
/*! exports provided: render, staticRenderFns */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _vue_loader_lib_loaders_templateLoader_js_vue_loader_options_vue_loader_lib_index_js_vue_loader_options_oembed_vue_vue_type_template_id_d056b306___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../../vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../vue-loader/lib??vue-loader-options!./oembed.vue?vue&type=template&id=d056b306& */ "../../node_modules/vue-loader/lib/loaders/templateLoader.js?!../../node_modules/vue-loader/lib/index.js?!../../node_modules/@base-cms/marko-web/browser/components/oembed.vue?vue&type=template&id=d056b306&");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "render", function() { return _vue_loader_lib_loaders_templateLoader_js_vue_loader_options_vue_loader_lib_index_js_vue_loader_options_oembed_vue_vue_type_template_id_d056b306___WEBPACK_IMPORTED_MODULE_0__["render"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return _vue_loader_lib_loaders_templateLoader_js_vue_loader_options_vue_loader_lib_index_js_vue_loader_options_oembed_vue_vue_type_template_id_d056b306___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"]; });



/***/ }),

/***/ "../../node_modules/babel-loader/lib/index.js?!../../node_modules/vue-loader/lib/index.js?!../../node_modules/@base-cms/marko-web/browser/components/oembed.vue?vue&type=script&lang=js&":
/*!*******************************************************************************************************************************************************************************************************!*\
  !*** /root/node_modules/babel-loader/lib??ref--1!/root/node_modules/vue-loader/lib??vue-loader-options!/root/node_modules/@base-cms/marko-web/browser/components/oembed.vue?vue&type=script&lang=js& ***!
  \*******************************************************************************************************************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _root_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! /root/node_modules/@babel/runtime/regenerator */ "../../node_modules/@babel/runtime/regenerator/index.js");
/* harmony import */ var _root_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_root_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _root_node_modules_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! /root/node_modules/@babel/runtime/helpers/asyncToGenerator */ "../../node_modules/@babel/runtime/helpers/asyncToGenerator.js");
/* harmony import */ var _root_node_modules_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_root_node_modules_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__);


//
//
//
//
//
//
//
//
//
//
//
//
//
/* harmony default export */ __webpack_exports__["default"] = ({
  props: {
    url: {
      type: String,
      required: true
    },
    expand: {
      type: Number,
      default: 250
    },
    attrs: {
      type: Object,
      default: function _default() {
        return {};
      }
    },
    mountPoint: {
      type: String,
      required: true
    }
  },
  data: function data() {
    return {
      loading: false,
      error: null,
      embed: null,
      oembedType: null,
      provider: null,
      observer: null
    };
  },
  computed: {
    id: function id() {
      var clean = "".concat(this.attrs.id).replace(/[\W|-]/ig, '');
      return "".concat(clean, "-").concat(Date.now());
    },
    html: function html() {
      if (this.embed) return this.embed;
      if (this.error) return "<pre>An unexpected error occurred: ".concat(this.error.message, "</pre>");
      if (this.loading) return "Loading embed from ".concat(this.url);
      return '';
    }
  },
  mounted: function mounted() {
    document.addEventListener('lazybeforeunveil', this.lazyload.bind(this));

    if (window.MutationObserver) {
      // inline script tags aren't added to the DOM, so the twitter widget never loads
      // This would be widespread -- if the payload returns a script tag, ensure that it is
      // appended to the head rather than written as part of the `embed` code here.
      this.observer = new MutationObserver(function (mutationList) {
        for (var i = 0; i < mutationList.length; i += 1) {
          var mutation = mutationList[i];

          if (mutation.type === 'childList') {
            for (var x = 0; x < mutation.addedNodes.length; x += 1) {
              var added = mutation.addedNodes[x];

              if (added.tagName && added.tagName === 'SCRIPT') {
                var script = document.createElement('script');

                for (var n = 0; n < added.attributes.length; n += 1) {
                  var _added$attributes$n = added.attributes[n],
                      name = _added$attributes$n.name,
                      value = _added$attributes$n.value;
                  script.setAttribute(name, value);
                }

                document.querySelector('head').appendChild(script);
              }
            }
          }
        }
      });
      var node = document.getElementById(this.id);
      this.observer.observe(node, {
        childList: true,
        subtree: true
      });
    }
  },
  beforeDestroy: function beforeDestroy() {
    document.removeEventListener('lazybeforeunveil', this.lazyload);
    if (this.observer) this.observer.disconnect();
  },
  methods: {
    lazyload: function lazyload(_ref) {
      var target = _ref.target;
      if (target.id === this.id) this.load();
    },
    load: function () {
      var _load = _root_node_modules_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()(
      /*#__PURE__*/
      _root_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee() {
        var href, r, _ref2, html, type, provider;

        return _root_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                this.loading = true;
                href = "".concat(this.mountPoint, "?url=").concat(encodeURIComponent(this.url));
                _context.prev = 2;
                _context.next = 5;
                return fetch(href, {
                  credentials: 'same-origin'
                });

              case 5:
                r = _context.sent;
                _context.next = 8;
                return r.json();

              case 8:
                _ref2 = _context.sent;
                html = _ref2.html;
                type = _ref2.type;
                provider = _ref2.provider_name;
                this.oembedType = type;
                this.provider = provider;
                this.embed = html;
                _context.next = 20;
                break;

              case 17:
                _context.prev = 17;
                _context.t0 = _context["catch"](2);
                // @todo Log this!
                this.error = _context.t0;

              case 20:
                _context.prev = 20;
                this.loading = false;
                document.removeEventListener('lazybeforeunveil', this.lazyload);
                return _context.finish(20);

              case 24:
              case "end":
                return _context.stop();
            }
          }
        }, _callee, this, [[2, 17, 20, 24]]);
      }));

      function load() {
        return _load.apply(this, arguments);
      }

      return load;
    }()
  }
});

/***/ }),

/***/ "../../node_modules/vue-loader/lib/loaders/templateLoader.js?!../../node_modules/vue-loader/lib/index.js?!../../node_modules/@base-cms/marko-web/browser/components/oembed.vue?vue&type=template&id=d056b306&":
/*!*************************************************************************************************************************************************************************************************************************************************!*\
  !*** /root/node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!/root/node_modules/vue-loader/lib??vue-loader-options!/root/node_modules/@base-cms/marko-web/browser/components/oembed.vue?vue&type=template&id=d056b306& ***!
  \*************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "render", function() { return render; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return staticRenderFns; });
var render = function() {
  var _vm = this
  var _h = _vm.$createElement
  var _c = _vm._self._c || _h
  return _c("span", {
    staticClass: "lazyload",
    attrs: {
      id: _vm.id,
      "data-embed-type": _vm.attrs.type,
      "data-oembed-type": _vm.oembedType,
      "data-oembed-provider": _vm.provider,
      "data-expand": _vm.expand
    },
    domProps: { innerHTML: _vm._s(_vm.html) }
  })
}
var staticRenderFns = []
render._withStripped = true



/***/ })

}]);
//# sourceMappingURL=oembed.21f32290.js.map